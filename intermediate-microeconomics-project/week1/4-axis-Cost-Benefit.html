<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Mini EconGraphs Demo</title>
  
 <!-- Import Desmos API -->
<script src="https://www.desmos.com/api/v1.11/calculator.js?apiKey=cc9b5d3cc1c2436aa4d9d33cf55073ca"></script>
   <!-- ================= NAVIGATION BAR ================= -->
  <link rel="stylesheet" href="../assets/site.css">
<link rel="stylesheet" href="../assets/graph.css?v=1">
  
</head>
  
<body class="graph-page">
  
  <div id="navbar-container"></div>
  <script src="../assets/navbarG-loader.js"></script>
<!-- =================================================== -->
 <div class="container"
     data-graph-id="4-axis-Cost-Benefit"
     data-graph-title="4 axis Cost&Benefit!">

    <!-- Page title -->
     <h1 data-fill="title"></h1>

        <!-- 3. Textbox section -->
    <section class="section">
      <h2>ðŸ“˜ Introduction!</h2>
      <div class="textbox" data-fill="intro"></div>
</section>
    
    <!-- 1. Desmos section -->
   <section class="section">
  <div class="section-header">
    <h2>ðŸ“ˆ Interactive Graph</h2>

    <a class="desmos-btn" data-fill="desmos-link" target="_blank" rel="noopener">
      Open in Desmos <!--Change desmos link above-->
    </a>
  </div>

   <div class="graph-scroll">
  <div class="graph-resizable" id="graphBox">
    <div class="graph-wrapper">
      <div id="calculator"></div>
    </div>
    <div class="resize-handle" aria-hidden="true" title="Drag to resize"></div>
  </div>
</div>

   </section>

    <!-- 2. Video section -->
   <section class="section">
  <h2>ðŸŽ¥ Video</h2>
 <div class="video-frame" data-fill="video"></div>
</section>

    <!-- 3. Textbox section -->
    <section class="section">
    <h2 data-fill="subtitle"></h2>
    <div class="textbox" data-fill="full"></div>
</section>

  </div>

<!--Desmos-->
<script defer src="../assets/desmos-loader.js"></script>
    <!--Export Desmos-->
<script defer src="../assets/export-desmos.js?v=1"></script>
    <!-- Import text-->
<script defer src="/intermediate-microeconomics-project/explanations.js?v=5"></script>
    <!--Import Desmos link-->
<script defer src="/intermediate-microeconomics-project/desmos-links.js"></script>
    <!--Import Video link-->
<script defer src="/intermediate-microeconomics-project/video.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const root = document.querySelector(".container[data-graph-id]");
  if (!root) return;

  const id = root.dataset.graphId;
  const title = root.dataset.graphTitle || id;

  // Grab globals safely even if they were defined with const/let
  const EXPL = (typeof EXPLANATIONS !== "undefined") ? EXPLANATIONS : null;
  const LINKS = (typeof DESMOS_LINKS !== "undefined") ? DESMOS_LINKS : null;
  const VIDS  = (typeof VIDEOS !== "undefined") ? VIDEOS : null;

  // Title + subtitle
  const titleEl = root.querySelector('[data-fill="title"]');
  if (titleEl) titleEl.textContent = title;

  const subtitleEl = root.querySelector('[data-fill="subtitle"]');
  if (subtitleEl) subtitleEl.textContent = `ðŸ“˜ ${title}`;

  // Explanations
  const introEl = root.querySelector('[data-fill="intro"]');
  if (introEl) {
    const introKey = `${id}-header`;
    if (EXPL && EXPL[introKey]) introEl.innerHTML = EXPL[introKey];
    else console.warn("Missing explanation for id:", introKey, "EXPL loaded?", !!EXPL);
  }

  const fullEl = root.querySelector('[data-fill="full"]');
  if (fullEl) {
    if (EXPL && EXPL[id]) fullEl.innerHTML = EXPL[id];
    else console.warn("Missing explanation for id:", id, "EXPL loaded?", !!EXPL);
  }

  // Desmos link
  const desmosA = root.querySelector('[data-fill="desmos-link"]');
  if (desmosA) {
    const entry = LINKS && LINKS[id];
    if (entry && entry.url) {
      desmosA.href = entry.url;
      desmosA.textContent = entry.title || "Open in Desmos";
    } else {
      console.warn("Missing Desmos link for:", id, "LINKS loaded?", !!LINKS);
    }
  }

  // Video
  const videoEl = root.querySelector('[data-fill="video"]');
  if (videoEl) {
    const v = VIDS && VIDS[id];
    if (v && v.src) {
      videoEl.innerHTML = `
        <iframe
          src="${v.src}"
          title="${v.title || ""}"
          allowfullscreen
        ></iframe>
      `;
    } else {
      console.warn("Missing video for:", id, "VIDS loaded?", !!VIDS);
    }
  }
});
</script>


  
</body>
</html>
